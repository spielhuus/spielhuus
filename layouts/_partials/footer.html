<div class="arrows">
  <div class="arrow background"></div>
  <div class="arrow orange"></div>
  <div class="arrow darkorange"></div>
  <div class="arrow redpastell"></div>
  <div class="arrow purple"></div>
</div>
<div class="footer">
  {{ $spielhuus := resources.Get "images/spielhuus.svg" }}
  {{ $github := resources.Get "images/github-mark.svg" }}
  <a href="/"><span class="icon icon-spielhuus"></span></a>
  <a href="https://github.com/spielhuus/"><span class="icon icon-github"></span></a>
  <br/>
  <span>Copyright {{ now.Year }}. All rights reserved.</span>
</div>

<script>
  // control the light/dark theme
  const themeToggleButton = document.getElementById('theme-toggle');
  const docElement = document.documentElement;

  window.themeController = {
    listeners: [], // This is your "listener array"

    // Method for other parts of the app (like Rust/WASM) to subscribe
    subscribe: function(callback) {
      this.listeners.push(callback);
      // Immediately notify the new subscriber of the current theme
      callback(localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));
    },

    // Notifies all listeners
    _notify: function(newTheme) {
      this.listeners.forEach(callback => callback(newTheme));
    },
    // The central function to set the theme
    setTheme: function(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);

      const themeToggleButton = document.getElementById('theme-toggle');
      if (theme === 'dark') {
        themeToggleButton.textContent = 'ðŸŒ™';
      } else {
        themeToggleButton.textContent = 'â˜€ï¸';
      }
      
      // Notify all subscribers about the change
      this._notify(theme);
    }
  };

  themeToggleButton.addEventListener('click', () => {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    window.themeController.setTheme(newTheme);
  });

  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    window.themeController.setTheme(savedTheme);
  } else {
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    window.themeController.setTheme(prefersDark ? 'dark' : 'light');
  }
</script>
